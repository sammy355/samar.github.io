---
title: "Improved Off-policy Reinforcement Learning in Biological Sequence Design"
date: 2026-02-16
permalink: /posts/2026/02/RL_seq/
tags:
  - deep-learning
  - Reinforcement-Learning
  - Biological-Sequence-Design
  - Proxy-training
  - ùúπ-Conservative-search
  - GFlowNets
math: true
---

## Abstract

Designing biological sequences such as DNA, RNA, and proteins is a central challenge in biotechnology due to the Huge search space and the high cost of estimation. Recent reinforcement learning (RL) approaches rely on proxy models to estimate quality, but these models often fail when exploring regions with unknown data. This paper introduces Œ¥-Conservative Search (Œ¥-CS), a novel off-policy reinforcement learning strategy that balances exploration and reliability in biological sequence design. The method focus on high-scoring known sequences by randomly masking tokens and then denoising them using a generative policy, ensuring that new candidates remain close to reliable regions of the search space. The degree of conservativeness is adaptively adjusted based on the proxy model‚Äôs uncertainty. Experiments across DNA, RNA, and protein design tasks demonstrate that Œ¥-CS consistently discovers higher quality sequences than existing methods. This makes Œ¥-CS a scalable and reliable framework for real-world biological design.

## Table of Contents

- [Introduction and Motivation](#introduction-and-motivation)  
- [Reinforcement Learning for Sequence Design](#reinforcement-learning-for-Sequence-design)
- [The Core Problem: Proxy Misspecification](#the-core-problem-proxy-misspecification)  
- [Key Idea: Delta Conservative Search](#key-idea-delta-conservative-search)  
- [Adaptive Conservativeness Using Uncertainty](#adaptive-conservativeness-using-uncertainty)  
- [Experimental Setup and Benchmarks](#experimental-setup-and-benchmarks)  
- [Results](#results)  
- [Conclusion](#conclusion)

## Introduction and Motivation

In Biotechnology, designing biological sequences is a central problem.‚Ä®For example, we may want to design DNA sequences with high binding affinity, RNA molecules with specific folding properties, or proteins with enhanced fluorescence or stability. However, this is extremely challenging. The search space for the sequences grows exponentially Large with increasing sequence length, which makes brute-force search impossible.‚Ä®Furthermore, evaluating these sequences using an evaluating function, usually known as "Oracle function" or simply what we call "wet-lab experiments" is very expensive and takes a lot of time. Also, evaluation using Detailed simulation is not very cost and time effective as well.

To address this problem, we often use machine learning models called proxy models. But these proxies are imperfect, they are not always accurate and can make unreliable predictions, especially for unknown sequences.‚Ä®This paper addresses exactly this issue by proposing a conservative search strategy that improves robustness without sacrificing exploration. It introduces a novel off-policy search method called Delta-Conservative Search (Œ¥-CS), which is designed to enhance the robustness of generative policies, specifically Generative Flow Networks (GFlowNets), for designing biological sequences such as DNA, RNA, and proteins<a href="#ref-1" title="(2025) Improved Off-policy Reinforcement Learning in Biological Sequence Design">[1]</a>.

## Reinforcement Learning for Sequence Design

Biological sequence design can be framed as a sequential decision-making problem, we build a sequence one token at a time, and at the end we receive a score that reflects how good that sequence is according to a set objective or goal. This process makes reinforcement learning (RL) a perfect fit.

In this setting, an agent generates a sequence step by step. Each action corresponds to choosing the next token, for example; a nucleotide or amino acid. And once the full sequence is constructed, it is evaluated by an oracle (often an expensive wet-lab experiment or a high-fidelity simulator). Because querying the oracle is costly, modern approaches rely on proxy models that approximate the oracle and provide fast reward estimates during training itself.

### On-policy Reinforcement Learning

Early RL-based approaches for sequence design relied on on-policy methods, meaning the policy is trained only on data generated by its current version. A representative example is DyNA PPO, which applies Proximal Policy Optimization (PPO) within an active learning loop. On-policy methods have some appealing properties. They are relatively stable, simple, and align well with classical RL theory. However, they come with a major drawback which is poor data efficiency. Since they cannot effectively reuse previously collected sequences, large amounts of expensive oracle evaluations are needed to make progress. This drawback becomes highly problematic when dealing with Huge search spaces, where exploring is essential.

### Off-policy Reinforcement Learning

To address the limitations of On-policy RL, researchers have turned to off-policy RL methods, which can learn from data generated by older policies or even from fixed offline datasets. This is very effective in biology, where historical datasets and previously evaluated sequences are often available.

One influential off-policy framework for sequence design is Generative Flow Networks (GFlowNets). Instead of learning a single optimal sequence, GFlowNets learn a distribution over sequences, where the probability of sampling a sequence is proportional to its reward. This allows them to generate high-quality sequences , a crucial property when exploring biological landscapes. Another advantage of GFlowNets is their flexibility, they can mix offline data (existing evaluated sequences) with newly generated samples, leading to more stable and efficient training compared to on-policy RL methods.


## The Core Problem: Proxy Misspecification

Beyond theoretical appeal, the DiffSBDD framework has demonstrated practical capabilities across a broad set of drug design scenarios that typically require dedicated tools. The model‚Äôs unified architecture, paired with its conditional generation and inpainting features, allows it to flexibly adapt to different application domains without retraining<a href="#ref-1" title="Hoogeboom et al. (2024) Structure-based drug design with equivariant diffusion models">[1]</a><a href="#ref-4" title="Lu et al. (2021) Pocket2Mol">[4]</a>.

Figure 8 showcases several inpainting-based applications made possible by DiffSBDD:

- **(A) Scaffold Hopping**: Replace the central core of a molecule while preserving key functional groups that engage in critical binding interactions.
- **(B) Scaffold Elaboration**: Add novel substituents to existing molecular cores to enhance affinity or selectivity.
- **(C) Fragment Merging**: Seamlessly combine two independently identified fragment binders into a single contiguous ligand.
- **(D) Fragment Growing**: Extend a small hit compound with new chemical moieties to improve pharmacokinetics or interaction footprint.
- **(E) Fragment Linking**: Bridge multiple fragment binders in spatial proximity using flexible or constrained linkers.

These applications are unified under the inpainting abstraction, where known atoms are fixed and missing regions are sampled via score-based diffusion. Notably, DiffSBDD succeeds even when the input fragments originate from different crystallographic structures, demonstrating robust generalization<a href="#ref-4" title="Lu et al. (2021) Pocket2Mol">[4]</a>.

Panels **(F)** and **(G)** illustrate the role of resampling. Increasing the number of diffusion resampling steps improves molecular connectivity‚Äîcrucial for generating synthetically viable and bioactive compounds. This iterative refinement process shows that longer sampling allows designed atoms to harmonize better with fixed regions and pocket geometry<a href="#ref-1" title="Hoogeboom et al. (2024) Structure-based drug design with equivariant diffusion models">[1]</a>.

Together, these capabilities make DiffSBDD a practical, versatile tool for medicinal chemistry workflows‚Äîfrom early-stage hit discovery to late-stage lead optimization.

![Figure 7: Diverse molecular design tasks enabled by DiffSBDD‚Äôs conditional generation.]({{ site.baseurl }}/images/fig8.png)
*Figure 7: DiffSBDD supports a variety of drug design scenarios using a unified inpainting mechanism. Tasks include scaffold hopping (A), elaboration (B), fragment merging (C), growing (D), and linking (E). Resampling studies (F‚ÄìG) show that connectivity improves with more iterations.*

## Key Idea: Delta Conservative Search

To evaluate DiffSBDD‚Äôs real-world utility, the authors benchmarked it against several state-of-the-art molecular generative models on two major datasets: CrossDocked and Binding MOAD. These datasets represent synthetic and experimental protein-ligand complexes, respectively<a href="#ref-1" title="Hoogeboom et al. (2024) Structure-based drug design with equivariant diffusion models">[1]</a><a href="#ref-7" title="Berman et al. (2000) Protein Data Bank">[7]</a>.

### Datasets

- **CrossDocked**: Designed to test generalization, where test proteins and ligands are held out from training. Useful for assessing binding pose recovery and diversity<a href="#ref-1" title="Hoogeboom et al. (2024) Structure-based drug design with equivariant diffusion models">[1]</a>.
- **Binding MOAD**: A high-quality dataset of crystal structures for real protein-ligand complexes. It evaluates biological realism and docking affinity<a href="#ref-7" title="Berman et al. (2000) Protein Data Bank">[7]</a>.

### Evaluation Metrics

Several performance dimensions were analyzed:

- **Tanimoto Similarity**: Measures structural similarity between generated ligands and reference ligands.
- **Vina Score Difference**: Difference in docking score relative to the native ligand.
- **QED (Quantitative Estimate of Drug-likeness)**: A metric reflecting how pharmacologically promising a molecule is<a href="#ref-6" title="Zhavoronkov et al. (2019) DDR1 Kinase Inhibitors">[6]</a>.
- **Ring Size Distribution**: Assesses realism of generated molecular scaffolds.
- **Enamine Similarity**: Indicates similarity to purchasable compounds from chemical catalogs.

![Figure 8: Benchmark comparison of DiffSBDD vs. baseline models.]({{ site.baseurl }}/images/fig7.png)  
*Figure 8: Benchmark comparison across CrossDocked (a‚Äìc) and Binding MOAD (d‚Äìf). Violin plots show Tanimoto similarity and Vina score difference (a, d). Bar charts compare ring-size frequencies (b, e). Molecular overlays (c, f) show QED and Vina scores for generated ligands.*

### Key Findings

### Summary of Benchmark Metrics

The table below summarizes key results comparing DiffSBDD variants against other generative baselines on the CrossDocked dataset:

| Model           | Tanimoto Similarity ‚Üë | Docking Score (Vina) ‚Üì | QED ‚Üë  | RMSD (√Ö) ‚Üì |
|----------------|------------------------|-------------------------|--------|------------|
| DiffSBDD-cond   | 0.68 ¬± 0.05            | -8.6                    | 0.82   | 1.9        |
| DiffSBDD-joint  | 0.65 ¬± 0.06            | -8.3                    | 0.80   | 2.1        |
| Pocket2Mol<a href="#ref-4" title="Lu et al. (2021) Pocket2Mol">[4]</a>      | 0.54 ¬± 0.07            | -7.6                    | 0.75   | 2.5        |
| ResGen          | 0.48 ¬± 0.06            | -7.4                    | 0.70   | 2.8        |
| DeepCL (2D)     | 0.45 ¬± 0.09            | -7.2                    | 0.71   | 2.9        |

#### 1. High-Fidelity Binding Poses

- DiffSBDD-generated molecules exhibit high binding site complementarity.
- Over 70% of structures achieve <2√Ö RMSD to native poses in CrossDocked, indicating precise 3D placement.

#### 2. Improved Docking and Drug-likeness

- DiffSBDD-cond and DiffSBDD-joint outperform baselines (Pocket2Mol<a href="#ref-4" title="Lu et al. (2021) Pocket2Mol">[4]</a>, ResGen, DeepCL) in both Tanimoto similarity and docking score metrics (Figures 7a and 7d).
- QED values are consistently higher for DiffSBDD ligands (Figures 7c and 7f), suggesting better pharmacological potential<a href="#ref-6" title="Zhavoronkov et al. (2019) DDR1 Kinase Inhibitors">[6]</a>.

#### 3. Ring System Recovery

- Generated molecules exhibit realistic ring-size distributions (Figures 7b and 7e), closely matching reference sets.
- This points to improved structural diversity and chemical plausibility.

#### 4. Visual Validation

- Visual overlays (Figures 7c and 7f) confirm that generated ligands align well within protein pockets, maintaining key interactions and matching the steric shape of known binders.


### Optimization of Molecular Properties and Specificity

Beyond generating plausible binders, DiffSBDD is also capable of optimizing specific molecular properties in an iterative and interpretable manner. The model allows property-guided sampling by combining diffusion with an oracle scoring loop that selectively amplifies molecules with desirable features<a href="#ref-1" title="Hoogeboom et al. (2024) Structure-based drug design with equivariant diffusion models">[1]</a><a href="#ref-6" title="Zhavoronkov et al. (2019) DDR1 Kinase Inhibitors">[6]</a>.

Figure 9 illustrates several key use cases of property optimization:

- **(A‚ÄìD)** show how different properties‚ÄîQED (drug-likeness), SA (synthetic accessibility), and docking scores‚Äîcan be individually improved over successive generations. Each property is optimized while keeping the molecular structure chemically valid and diverse.
- **(E‚ÄìF)** demonstrate specificity control: here, DiffSBDD successfully optimizes a ligand to favor binding to one kinase (BIKE) while reducing affinity for an off-target kinase (MPSK1). A trajectory plot shows improvement in on-target docking score and simultaneous degradation in off-target score.
- **(G)** overlays the original and optimized molecules within both protein pockets, visually confirming that the optimized molecule adopts a more selective binding conformation.

This illustrates DiffSBDD‚Äôs capacity to navigate trade-offs between affinity, selectivity, and synthesizability‚Äîcrucial for real-world lead optimization tasks. The model effectively functions as a molecular policy engine, where each generation is guided by multi-objective scores, converging on candidates with favorable profiles<a href="#ref-6" title="Zhavoronkov et al. (2019) DDR1 Kinase Inhibitors">[6]</a>.

![Figure 9: Property and selectivity optimization using DiffSBDD.]({{ site.baseurl }}/images/fig9.png)
*Figure 9: DiffSBDD supports multi-objective optimization of molecules for improved drug-likeness, docking, and target specificity. Panels (A‚ÄìD) show iterative improvement across QED, SA, and docking score. Panel (E) shows kinase overlay. Panel (F) shows optimization trajectory. Panel (G) visualizes specificity control in binding conformations.*

## Adaptive Conservativeness Using Uncertainty

While DiffSBDD is an exciting leap in generative drug design, a critical examination helps clarify both its unique strengths and its current limitations‚Äîcrucial for evaluating real-world impact<a href="#ref-1" title="Hoogeboom et al. (2024) Structure-based drug design with equivariant diffusion models">[1]</a>.

### Strengths

- **Unified Framework**: Unlike many pipelines that require separate models for generation, linking, and optimization, DiffSBDD handles all of them within a single architecture. This not only reduces training complexity but makes inference modular and efficient<a href="#ref-1" title="Hoogeboom et al. (2024) Structure-based drug design with equivariant diffusion models">[1]</a>.
- **Geometrically Grounded Generation**: The use of SE(3)-equivariant score models ensures physical consistency across 3D transformations. This is critical for modeling steric complementarity and ligand‚Äìprotein docking accuracy, where orientation and spatial fit govern binding<a href="#ref-2" title="Satorras et al. (2021) E(n) Equivariant Graph Neural Networks">[2]</a>.
- **Controllability via Inpainting**: DiffSBDD's inpainting mechanism provides flexibility to anchor known fragments while generating novel extensions‚Äîenabling real-world tasks like scaffold hopping, R-group decoration, and fragment linking without retraining<a href="#ref-1" title="Hoogeboom et al. (2024) Structure-based drug design with equivariant diffusion models">[1]</a><a href="#ref-4" title="Lu et al. (2021) Pocket2Mol">[4]</a>.
- **Reflection Sensitivity**: Many prior models only consider SO(3) invariance (rotations), ignoring chirality. DiffSBDD‚Äôs sensitivity to reflection enables it to distinguish stereoisomers‚Äîa crucial requirement in pharmaceutical design where enantiomers can behave drastically differently<a href="#ref-1" title="Hoogeboom et al. (2024) Structure-based drug design with equivariant diffusion models">[1]</a>.
- **Interpretable Optimization**: The integration of oracle-based feedback into the generation loop offers a form of iterative property tuning that is not only effective but also easy to visualize and audit‚Äîespecially helpful for lead optimization tasks<a href="#ref-6" title="Zhavoronkov et al. (2019) DDR1 Kinase Inhibitors">[6]</a>.

### Limitations

- **Lack of Experimental Validation**: All current results are computational. Without wet-lab synthesis and binding assays, the model‚Äôs real-world drug development potential remains speculative<a href="#ref-1" title="Hoogeboom et al. (2024) Structure-based drug design with equivariant diffusion models">[1]</a><a href="#ref-6" title="Zhavoronkov et al. (2019) DDR1 Kinase Inhibitors">[6]</a>.
- **Static Protein Representation**: The current framework treats the protein pocket as rigid. This assumption may not hold in cases where induced fit or flexible loops are critical for binding, potentially limiting generalizability<a href="#ref-7" title="Berman et al. (2000) Protein Data Bank">[7]</a>.
- **Oracle Dependence in Optimization**: While oracles enable goal-directed sampling, they can also inject bias. If the scoring functions do not fully capture biological context (e.g., off-target effects, ADMET), the model might over-optimize for flawed objectives<a href="#ref-6" title="Zhavoronkov et al. (2019) DDR1 Kinase Inhibitors">[6]</a>.
- **Computational Cost**: Score-based diffusion and SE(3)-equivariant message passing are compute-intensive. This can make training or high-throughput generation slower compared to simpler models, limiting use in large-scale virtual screening campaigns.

### Future Directions

- **Protein Flexibility Modeling**: Introducing dynamic or ensemble-based representations of the binding site could help model induced-fit effects and improve generalizability.

- **Experimental Coupling**: Downstream synthesis and bioassays will be crucial to validate predictions and calibrate oracle scores against biological ground truth.

- **Synthesis-Aware Generation**: Incorporating retrosynthesis constraints or training with synthesis-aware scores could prevent generation of chemically invalid or impractical molecules.

- **Expansion to Other Domains**: The same principles could extend to enzyme engineering, materials discovery, or even battery electrolytes, where 3D interactions matter but datasets are small‚Äîmaking equivariant priors even more valuable.

## Experimental Setup and Benchmarks

DiffSBDD exemplifies how machine learning can accelerate drug discovery, reducing costs and time by exploring vast chemical space efficiently<a href="#ref-1" title="Hoogeboom et al. (2024) Structure-based drug design with equivariant diffusion models">[1]</a><a href="#ref-6" title="Zhavoronkov et al. (2019) DDR1 Kinase Inhibitors">[6]</a>. The method paves the way for AI-driven precision medicine, improved catalysts, and advanced materials. Ethical considerations include ensuring equitable access to such technologies and careful validation to avoid biased or unsafe outputs.

This framework can inspire similar applications in materials science, agrochemistry, and beyond, highlighting the growing impact of equivariant generative models in physical sciences<a href="#ref-2" title="Satorras et al. (2021) E(n) Equivariant Graph Neural Networks">[2]</a>.

## Results


## Conclusion

DiffSBDD represents a significant advance in computational drug design by combining equivariant neural architectures with diffusion probabilistic models. Its unified, physically consistent approach enables flexible generation and optimization of drug candidates directly in protein binding sites. With promising benchmark results and broad applicability, DiffSBDD charts a course for more efficient, innovative, and accurate AI-assisted molecular design<a href="#ref-1" title="Hoogeboom et al. (2024) Structure-based drug design with equivariant diffusion models">[1]</a>.


<a id="ref-1"></a>
<a id="ref-2"></a>
<a id="ref-3"></a>
<a id="ref-4"></a>
<a id="ref-5"></a>
<a id="ref-6"></a>
<a id="ref-7"></a>
<a id="ref-8"></a>
## References

1. Hyeonah Kim, Minsu Kim, Taeyoung Yun, Sanghyeok Choi, Emmanuel Bengio, Alex Hern√°ndez-Garc√≠a, Jinkyoo Park (2025). Improved Off-policy Reinforcement Learning in Biological Sequence Design. [https://arxiv.org/abs/2102.09844  ](https://arxiv.org/abs/2410.04461)
2. Satorras, V. G., Hoogeboom, E., Fuchs, F. B., & Welling, M. (2021). E(n) Equivariant Graph Neural Networks. *arXiv preprint arXiv:2102.09844*. https://arxiv.org/abs/2102.09844  
3. Xu, M., Wang, Y., Hu, W., & Leskovec, J. (2021). GeoDiff: A Geometric Diffusion Model for Molecular Conformation Generation. *ICLR 2022*. https://arxiv.org/abs/2203.02923  
4. Lu, C., Wu, H., Shen, R., & Cao, Y. (2021). Pocket2Mol: Efficient Molecular Generation Based on Binding Pockets. *NeurIPS 2021*. https://arxiv.org/abs/2110.07875  
5. Ganea, O.-E., Huang, J., Bunne, C., & Krause, A. (2021). Independent SE(3)-Equivariant Models for End-to-End Rigid Protein Docking. *arXiv preprint arXiv:2111.07786*. https://arxiv.org/abs/2111.07786  
6. Zhavoronkov, A., Ivanenkov, Y. A., Aliper, A., et al. (2019). Deep learning enables rapid identification of potent DDR1 kinase inhibitors. *Nature Biotechnology*, 37(9), 1038‚Äì1040. https://doi.org/10.1038/s41587-019-0224-x  
7. Berman, H. M., et al. (2000). The Protein Data Bank. *Nucleic Acids Research*, 28(1), 235‚Äì242. https://doi.org/10.1093/nar/28.1.235  
8. Huuskonen, J. (2000). Estimation of Aqueous Solubility for a Diverse Set of Organic Compounds Based on Molecular Topology. *Journal of Chemical Information and Computer Sciences*, 40(3), 773‚Äì777. https://doi.org/10.1021/ci990307l  


